<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tactics UI</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

<div class="container-fluid my-4">
  <div class="row">
    <!-- Left team (Red Team) -->
    <div class="col-12 col-md-6 pe-md-2">
      <div class="p-2 h-100" style="background-color: salmon;">
        <!-- Character cards will be injected here -->
      </div>
    </div>

    <!-- Right team (Blue Team) -->
    <div class="col-12 col-md-6 ps-md-2">
      <div class="p-2 h-100" style="background-color: lightblue;">
        <!-- Character cards will be injected here -->
      </div>
    </div>
  </div>
</div>

<!-- JavaScript -->
<script>
const characters = [
  {
    id: 1,
    name: 'Alpha',
    rank: 2,
    body1: 'Large',
    body2: 'Armored',
    body3: '-',
    type1: 'Tank',
    type2: 'Steel',
    hp: 10,
    shield: 5,
    power: 8,
    move: 3,
    max: 20,
    abilityName: 'Shield Wall',
    abilityDescription: 'Reduces incoming damage by 50% for two turns.',
    teamBgColor: '#f8d7da' // red team color
  }
];

// Stat max values
const statMax = {
  1: 20,
};

function createCharacterCard(character) {
  const template = document.getElementById('character-card-template');
  const clone = template.content.cloneNode(true);

  clone.querySelector('.character-card').style.backgroundColor = character.teamBgColor;

  clone.querySelector('.rank').innerText = character.rank;
  clone.querySelector('.name').innerText = character.name;

  clone.querySelector('.body1').innerText = character.body1;
  clone.querySelector('.body2').innerText = character.body2;
  clone.querySelector('.body3').innerText = character.body3;
  clone.querySelector('.type1').innerText = character.type1;
  clone.querySelector('.type2').innerText = character.type2;

  clone.querySelector('.hp-value').innerText = character.hp;
  clone.querySelector('.shield-value').innerText = character.shield;
  clone.querySelector('.power-value').innerText = character.power;
  clone.querySelector('.move-value').innerText = character.move;

  clone.querySelector('.hp-max').innerText = character.max;
  clone.querySelector('.shield-max').innerText = character.max;
  clone.querySelector('.power-max').innerText = character.max;
  clone.querySelector('.move-max').innerText = character.max;

  clone.querySelector('.ability-name').innerText = character.abilityName;
  clone.querySelector('.ability-description').innerText = character.abilityDescription;

  // ðŸ”¥ Auto-assign IDs here:
  clone.querySelector('.hp-value').id = `hp-${character.id}`;
  clone.querySelector('.shield-value').id = `shield-${character.id}`;
  clone.querySelector('.power-value').id = `power-${character.id}`;
  clone.querySelector('.move-value').id = `move-${character.id}`;

  // Also update the onclick functions in buttons
  const buttons = clone.querySelectorAll('.btn-minus, .btn-plus');
  buttons.forEach(button => {
    const isMinus = button.classList.contains('btn-minus');
    const statType = button.closest('.card').querySelector('.fs-4').classList[1].split('-')[0]; // hp, shield, etc.
    button.setAttribute('onclick', `${isMinus ? 'decrease' : 'increase'}('${statType}-${character.id}')`);
  });

  return clone;
}


function updateButtons(id) {
  const card = document.getElementById(id).closest('.card');
  const valueEl = document.getElementById(id);
  const minusBtn = card.querySelector('.btn-minus');
  const plusBtn = card.querySelector('.btn-plus');

  const current = parseInt(valueEl.innerText);
  const max = statMax[id.split('-')[1]];

  minusBtn.disabled = (current <= 0);
  plusBtn.disabled = (current >= max);
}

function decrease(id) {
  const valueEl = document.getElementById(id);
  let current = parseInt(valueEl.innerText);
  if (current > 0) {
    valueEl.innerText = current - 1;
    updateButtons(id);
  }
}

function increase(id) {
  const valueEl = document.getElementById(id);
  let current = parseInt(valueEl.innerText);
  const max = statMax[id.split('-')[1]];
  if (current < max) {
    valueEl.innerText = current + 1;
    updateButtons(id);
  }
}

function setupButtonLogic() {
  document.querySelectorAll('.card .btn-minus, .card .btn-plus').forEach(btn => {
    btn.addEventListener('click', () => {
      const valueEl = btn.closest('.card').querySelector('.fs-4');
      if (valueEl && valueEl.id) {
        updateButtons(valueEl.id);
      }
    });
  });
}

window.addEventListener('DOMContentLoaded', () => {
  fetch('char-card.html')
    .then(response => response.text())
    .then(html => {
      const templateContainer = document.createElement('div');
      templateContainer.innerHTML = html;
      document.body.appendChild(templateContainer);

      const leftTeam = document.querySelector('.col-md-6.pe-md-2 > div');
      const rightTeam = document.querySelector('.col-md-6.ps-md-2 > div');

      characters.forEach((character, index) => {
        const card = createCharacterCard(character);

        if (index < 3) {
          leftTeam.appendChild(card);
        } else {
          rightTeam.appendChild(card);
        }
      });

      setupButtonLogic();
    });
});
</script>

</body>
</html>
